library(phyloseq)
BiocManager::install(version = "3.10")
library(phyloseq)
BiocManager::install("phyloseq")
BiocManager::install("ggplot2")
library(phyloseq)
library(ggplot2)
vignette(phyloseq)
otumat <- read.table("../tables/otu_table_tax_amostras.tsv",sep="\t",header=T,row.names=1)
otumat
plot_bar(otumat, x="Dia de desmame", fill="Species")
rownames(otumat) <- paste0("OTU", 1:nrow(otumat))
colnames(otumat) <- paste0("Sample / day", 1:ncol(otumat))
otumat
# Importa OTU table
otumat <- read.table("../tables/otu_table_tax_amostras.tsv", sep="\t", header=T, row.names=1)
otumat
taxmat = read.table("../tables/tax_table_amostras.tsv", sep="\t", header=T, row.names=1)
taxmat = read.table("../tables/tax_table_amostras.tsv", sep="\t", header=T, row.names=1)
rownames(taxmat) <- rownames(otumat)
colnames(taxmat) <- c("Sci_name", "Domain", "Phylum", "Class", "Order", "Family", "Genus", "Species")
colnames(taxmat) <- c("Domain", "Phylum", "Class", "Order", "Family", "Genus", "Species")
taxmat
class(otumat)
class(taxmat)
OTU = otu_table(otumat, taxa_are_rows = TRUE)
TAX = tax_table(taxmat)
OTU
TAX = tax_table(taxmat)
OTU
TAX
physeq = phyloseq(OTU, TAX)
physeq
class(otumat)
class(taxmat)
# Importa OTU table
otumat <- as.matrix(read.table("../tables/otu_table_tax_amostras.tsv", sep="\t", header=T, row.names=1))
otumat
taxmat = as.matrix(read.table("../tables/tax_table_amostras.tsv", sep="\t", header=T, row.names=1))
rownames(taxmat) <- rownames(otumat)
colnames(taxmat) <- c("Domain", "Phylum", "Class", "Order", "Family", "Genus", "Species")
taxmat
class(otumat)
class(taxmat)
OTU = otu_table(otumat, taxa_are_rows = TRUE)
TAX = tax_table(taxmat)
OTU
TAX
physeq = phyloseq(OTU, TAX)
physeq
plot_bar(otumat, x="Dia de desmame", fill="Species")
plot_bar(physeq, fill = "Species")
plot_bar(physeq, fill = "Genus")
TopNOTUs <- names(sort(taxa_sums(physeq), TRUE)[1:50])
TopNOTUs <- names(sort(taxa_sums(physeq), TRUE)[1:50])
to_50   <- prune_taxa(TopNOTUs, physeq)
print(to_50)
plot_bar(physeq, x="Dias após desmame", y="Abundância", fill = "Genus")
plot_bar(physeq, x="Dias apos desmame", y="Abundância", fill = "Genus")
print(top_50)
TopNOTUs <- names(sort(taxa_sums(physeq), TRUE)[1:50])
to_50   <- prune_taxa(TopNOTUs, physeq)
print(top_50)
TopNOTUs <- names(sort(taxa_sums(physeq), TRUE)[1:50])
top_50   <- prune_taxa(TopNOTUs, physeq)
print(top_50)
plot_bar(physeq, x="Dias apos desmame", y="Abundância", fill = "Genus")
plot_bar(physeq, x="Dias", y="Abundância", fill = "Genus")
plot_bar(physeq, x="Dias", y="Abundância", fill = "Genus")
plot_bar(top_50, fill = "Genus")
TopNOTU_species <- names(sort(taxa_sums(physeq), TRUE)[1:50])
top_50_species   <- prune_taxa(TopNOTU_species, physeq)
print(top_50_species)
TopNOTU_species <- names(sort(taxa_sums(physeq), TRUE)[1:50])
top_50_species   <- prune_taxa(TopNOTU_species, physeq)
print(top_50_species)
plot_bar(top_50_species, fill = "Species")
# Importa OTU table
otumat <- as.matrix(read.table("../tables/otu_table_tax_amostras.tsv", sep="\t", header=T, row.names=1))
otumat
taxmat = as.matrix(read.table("../tables/tax_table_amostras.tsv", sep="\t", header=T, row.names=1))
rownames(taxmat) <- rownames(otumat)
colnames(taxmat) <- c("Domain", "Phylum", "Class", "Order", "Family", "Genus", "Species")
taxmat
class(otumat)
class(taxmat)
OTU = otu_table(otumat, taxa_are_rows = TRUE)
TAX = tax_table(taxmat)
OTU
TAX
physeq = phyloseq(OTU, TAX)
physeq
TopNOTU_genus <- names(sort(taxa_sums(physeq), TRUE)[1:50])
top_50_genus   <- prune_taxa(TopNOTU_genus, physeq)
print(top_50_genus)
plot_bar(top_50_genus, fill = "Genus")
TopNOTU_species <- names(sort(taxa_sums(physeq), TRUE)[1:50])
top_50_species   <- prune_taxa(TopNOTU_species, physeq)
print(top_50_species)
plot_bar(top_50_species, fill = "Species")
TopNOTU_genus <- names(sort(taxa_sums(physeq), TRUE)[1:50])
top_50_genus   <- prune_taxa(TopNOTU_genus, physeq)
print(top_50_genus)
plot_bar(top_50_genus, fill = "Genus")
TopNOTU_species <- names(sort(taxa_sums(physeq), TRUE)[1:50])
top_50_species   <- prune_taxa(TopNOTU_species, physeq)
print(top_50_species)
plot_bar(top_50_species, fill = "Species")
